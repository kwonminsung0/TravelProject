# ✈Travel MVC Project

## 📖프로젝트 소개
고객, 가이드, 여행상품, 리뷰, 예약 정보를 입력하고
수정, 삭제, 목록 출력 및 특정 조건으로 정렬이 가능한
여행 대행사 프로그램입니다.

## 📆개발 기간
* 24.11.27(수) ~ 24.12.01(일)

### 🖥개발 환경
* `JavaSE 21`
* `JDK 21.0.4`
* `ECLIPSE IDE : 4.33.0`
* `DataBase : Oracle DB(21cXE)`

## 📌주요 기능
**고객**
* 고객 정보 입력, 수정, 삭제, 출력, 정렬(CRUD)
<details>
<summary><b>INSERT</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/customer_insert.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>SELECT</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/customer_select.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>UPDATE</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/customer_update.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>DELETE</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/customer_delete.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>SORT</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/customer_sort.png width = "400px" height = "200px">  
</details>

___

**예약**
* 예약 정보 입력, 수정, 삭제, 출력, 정렬(CRUD)
<details>
<summary><b>INSERT</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/reservation_insert.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>SELECT</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/reservation_select.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>UPDATE</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/reservation_update.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>DELETE</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/reservation_delete.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>SORT</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/reservation_sort.png width = "400px" height = "200px">  
</details>

___

**패키지**
* 여행상품 정보 입력, 수정, 삭제, 출력, 정렬(CRUD)
<details>
<summary><b>INSERT</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/package_insert.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>SELECT</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/package_select.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>UPDATE</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/package_update.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>DELETE</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/package_delete.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>SORT</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/package_sort.png width = "400px" height = "200px">  
</details>

___

**가이드**
* 가이드 정보 입력, 수정, 삭제, 출력, 정렬(CRUD)
<details>
<summary><b>INSERT</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/guide_insert.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>SELECT</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/guide_select.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>UPDATE</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/guide_update.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>DELETE</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/guide_delete.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>SORT</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/guide_sort_after.png width = "400px" height = "200px">  
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/guide_sort_before.png width = "400px" height = "200px"> 
</details>

___

**리뷰**
* 후기 정보 입력, 수정, 삭제, 출력, 정렬(CRUD)
<details>
<summary><b>INSERT</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/review_insert.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>SELECT</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/review_select.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>UPDATE</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/review_update.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>DELETE</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/review_delete.png width = "400px" height = "200px">  
</details>
<details>
<summary><b>SORT</b></summary>
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/review_sort.png width = "400px" height = "200px">  
</details>

___

## ✏쿼리문
```
-- DROP 기존 테이블 및 시퀀스
BEGIN
    EXECUTE IMMEDIATE 'DROP TABLE REVIEW CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE RESERVATION CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE PACKAGE CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE GUIDE CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE CUSTOMER CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP SEQUENCE CUSTOMER_SEQ';
    EXECUTE IMMEDIATE 'DROP SEQUENCE GUIDE_SEQ';
    EXECUTE IMMEDIATE 'DROP SEQUENCE PACKAGE_SEQ';
    EXECUTE IMMEDIATE 'DROP SEQUENCE RESERVATION_SEQ';
    EXECUTE IMMEDIATE 'DROP SEQUENCE REVIEW_SEQ';
EXCEPTION
    WHEN OTHERS THEN NULL;
END;
/

-- 고객 테이블
CREATE TABLE CUSTOMER (
    NO NUMBER, --PK
    ID VARCHAR2(30), --UK
    NAME VARCHAR2(50) NOT NULL,
    BIRTH NUMBER NOT NULL,
    NATIONAL VARCHAR2(20) NOT NULL,
    GENDER VARCHAR2(10) NOT NULL,
    EMAIL VARCHAR2(50) NOT NULL,
    PHONE VARCHAR2(14) NOT NULL
);
Alter table CUSTOMER add constraint CUSTOMER_NO_PK primary key(NO);
Alter table CUSTOMER add constraint CUSTOMER_ID_UK UNIQUE(ID); 

CREATE SEQUENCE CUSTOMER_SEQ
START WITH 1
INCREMENT BY 1;

-- 가이드 테이블
CREATE TABLE GUIDE (
    NO NUMBER, --PK
    ID VARCHAR2(30), --UK
    NAME VARCHAR(50) NOT NULL,
    PHONE VARCHAR(15) NOT NULL,
    LANGUAGES VARCHAR(100) NOT NULL
);
Alter table GUIDE add constraint GUIDE_NO_PK primary key(NO);
Alter table GUIDE add constraint GUIDE_ID_UK UNIQUE(ID); 

CREATE SEQUENCE GUIDE_SEQ
START WITH 1
INCREMENT BY 1;

-- 여행상품 테이블
CREATE TABLE PACKAGE (
    NO NUMBER, --PK
    ID VARCHAR2(30),--UK
    NAME VARCHAR2(50) NOT NULL,
--    PCAPACITY NUMBER,
    NATIONAL VARCHAR2(20) NOT NULL,
    PRICE NUMBER NOT NULL,
    GUIDE_ID VARCHAR2(30), --FK
    SDATE DATE DEFAULT SYSDATE,
    EDATE DATE DEFAULT SYSDATE
);
Alter table PACKAGE add constraint PACKAGE_NO_PK primary key(NO);
Alter table PACKAGE add constraint PACKAGE_ID_UK UNIQUE(ID);   
Alter table PACKAGE add constraint PACKAGE_GUIDE_ID_FK 
    FOREIGN key(GUIDE_ID) References GUIDE(ID) on delete set null;
 

CREATE SEQUENCE PACKAGE_SEQ
START WITH 1
INCREMENT BY 1;

--drop table reservation;
--drop table review;
-- 예약 테이블
CREATE TABLE RESERVATION(
    NO NUMBER, --PK
    ID VARCHAR2(30), --UK
    CUST_ID VARCHAR2(30), --FK
    PACK_ID VARCHAR2(30), --FK
--    RCAPACITY NUMBER NOT NULL,
    METHOD VARCHAR2(20) NOT NULL,
    RDATE DATE DEFAULT SYSDATE
);
Alter table RESERVATION add constraint RESERVATION_NO_PK primary key(NO);
Alter table RESERVATION add constraint RESERVATION_ID_UK UNIQUE(ID);  
Alter table RESERVATION add constraint RESERVATION_CUST_ID_FK 
    FOREIGN key(CUST_ID) References CUSTOMER(ID) on delete set null;
Alter table RESERVATION add constraint RESERVATION_PACK_ID_FK 
    FOREIGN key(PACK_ID) References PACKAGE(ID) on delete set null;   
ALTER TABLE RESERVATION MODIFY RDATE DEFAULT SYSDATE;  
       
CREATE SEQUENCE RESERVATION_SEQ
START WITH 1
INCREMENT BY 1;

-- 리뷰 테이블
CREATE TABLE REVIEW(
    NO NUMBER, --PK
    RESERV_ID VARCHAR2(30), --FK
    GUIDE_REVIEW NUMBER(2) NOT NULL,
    SCHE_REVIEW NUMBER(2) NOT NULL,
    AVG_REVIEW NUMBER(3, 1)
);
Alter table REVIEW add constraint REVIEW_NO_PK primary key(NO);
Alter table REVIEW add constraint REVIEW_RESERV_ID_FK 
    FOREIGN key(RESERV_ID) References RESERVATION(ID) on delete set null;
  
--  drop sequence review_seq;    
CREATE SEQUENCE REVIEW_SEQ
START WITH 1
INCREMENT BY 1;

COMMIT;


--=============================================================================================
-- 리뷰의 평균값 구하는 트리거
CREATE OR REPLACE TRIGGER REVIEW_TRIGGER
BEFORE INSERT OR UPDATE ON REVIEW
FOR EACH ROW
BEGIN
    IF :NEW.GUIDE_REVIEW IS NOT NULL AND :NEW.SCHE_REVIEW IS NOT NULL THEN
        :NEW.AVG_REVIEW := (:NEW.GUIDE_REVIEW + :NEW.SCHE_REVIEW) / 2;
    ELSE
        -- 기본값 설정
        :NEW.AVG_REVIEW := 0;
    END IF;
END;
/
```

## 📖테이블 정보
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/travel_table.png>

## 📖ERD 다이어그램
<img src=https://github.com/kwonminsung0/TravelProject/blob/main/image/travel_erd.png>
